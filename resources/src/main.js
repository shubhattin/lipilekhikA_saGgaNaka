class लिपिलेखिकासहायक{constructor(){this.akSharAH={Normal:{}},this.loaded_scripts=["Normal"],this.antar_load=!1;this.sanchit="src/dattAMsh",this.pratyakSharAH={};let t=new Set;for(let a in this.akSharAH){let i=this.akSharAH[a];for(let a in i)"く"!=a&&t.add(a)}this.alph=["ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz"],this.pUrNasarve=this.alph[0]+this.alph[1]+"01234567890'$.#?",this.re_arrange_num=(t=>t.replace(/[0-9]/g,"")+t.replace(/\D/g,""));this.is_mobile=function(){let t=!1;var a;return a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(t=!0),t}()}load_inter_converter(t=null){this.antar_load||($.ajax({url:this.sanchit+"/antar.json",success:a=>{this.pratyakSharAH=a,null!=t&&t()}}),this.antar_load=!0)}load_lang(t,a=null,i=null){if(t="Devanagari"==t?"Sanskrit":t,!this.includes(this.loaded_scripts,t))return $.ajax({url:this.sanchit+`/${t}.json`,success:s=>{this.akSharAH[t]=s,this.loaded_scripts.push(t),LipiLekhikA.clear_all_val(!0),null!=a&&a(),null!=i&&i()}});null!=a&&a(),null!=i&&i()}includes(t,a){return-1!=t.indexOf(a)}is_lower(t){return this.includes(this.alph[1],t)}is_null(t){return null==t||null==t}is_upper(t){return this.includes(this.alph[0],t)}to_lower(t){return this.alph[1][this.alph[0].indexOf(t)]}to_upper(t){return this.alph[0][this.alph[1].indexOf(t)]}time(){return(new Date).getTime()/1e3}clear(t){if(this.is_mobile)return;let a=t.key;this.includes(["ArrowDown","ArrowLeft","ArrowUp","ArrowRight"],a)&&LipiLekhikA.clear_all_val(!0)}replace_all(t,a,i){a=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var s=new RegExp(a,"g");return t.replace(s,i)}text_to_html(t){return this.replace_all("<div>"+t+"</div>","\n","</div><div>")}get_value(t){return document.getElementById(t).value}get_element(t){return document.getElementById(t)}set_html(t,a){let i=this.get_element(t);null!=i&&null!=i&&(i.innerHTML=a)}set_value(t,a){this.get_element(t).value=a}last(t,a=-1){if(null==t||null==t)return"";return t[t.length+a]}dict_rev(t){let a={};for(let i in t)a[t[i]]=i;return a}substring(t,a,i=null){return null==i&&(i=t.length),i>0?t.substring(a,i):i<0?t.substring(a,t.length+i):void 0}get_Text_from_div(t){t=this.replace_all(t,"&nbsp;"," "),t=this.replace_all(t,"&amp;",""),t=this.replace_all(t,"<br>","\n"),t=this.replace_all(t,"<br/>","\n"),t=this.replace_all(t,"<br />","\n"),t=this.replace_all(t,"</p>","觀");let a="",i=!1;for(let s of t)"<"==s&&(i=!0),i?">"==s&&(i=!1):a+=s;return a=this.replace_all(a,"觀\n","\n"),a=this.replace_all(a,"觀","\n")}}let LIPI=new लिपिलेखिकासहायक;class लिपिलेखिकापरिवर्तक{constructor(){this.karya=!1,this.time=LIPI.time(),this.zero_joiner="‌",this.back_space=0,this.sahayika_usage=!0,this.halant_add_status=!1,this.varna=["","",""],this.next_chars="",this.d=!1,this.mAtrA_sthiti=!1,this.madhye=!1,this.capital=[0,"",-1,-1,0,0,!1],this.store_last_of_3="",this.added_fonts=[],this.last_of_3_status_for_mAtrA=!1,this.special_ved_s=!1,this.usage_table_link=((t,a="https://cdn.jsdelivr.net/gh/nirukta/a@main/img/lang")=>{let i=t;return i="Kashmiri"==i?"Urdu":i,`${a}/${i=LIPI.includes(["Devanagari","Marathi","Konkani","Sanskrit","Nepali"],i)?"Hindi":i}.png`}),this.pUrva_lekhit=[["",-1],["",-1],["",-1],["",-1],["",-1]],this.second_cap_time=0,this.sahayika=new लिपिलेखिकालेखनसहायिका,this.set_interface_lang=((t="English")=>this.sahayika.load_lang(t,LIPI.sanchit)),this.hide=(()=>this.sahayika.elm.hide()),this.from_click=!1}set_lang_and_state(t,a=console.log,i=null){LIPI.load_lang(t,()=>{this.script=t,null!=i&&(this.karya=i),this.akSharANi=LIPI.akSharAH[this.script],this.sa_lang=this.akSharANi["く"]},a),this.add_font(t)}mukhya(t,a){if(!this.karya)return;if(LIPI.includes(t.attr("class"),"Lipi-LekhikA-Off"))return;if(null==(a=a.data)||null==a)return void this.clear_all_val(!0);a=a.substring(a.length-1);let i=this.elphased_time()<15;LIPI.includes(LIPI.pUrNasarve,a)?(i||this.clear_all_val(!0),this.prakriyA(a,1,this.script,this.sa_lang,t)):this.clear_all_val(!0)}elphased_time(){let t=this.time,a=LIPI.time(),i=a-t;return this.time=a,i}prakriyA(t,a,i,s,e=null,l=!1){this.akSharANi=LIPI.akSharAH[i],this.halant=LIPI.includes(["Normal","Romanized","Urdu","Kashmiri"],i)?"":this.akSharANi["."][".x"][0];let h=0==s&&1==a?0:1;if(this.dev_text=[],null==t||null==t)return;if(l=!(0!=a||!l)){let a=t;a=LIPI.replace_all(a,"&nbsp;"," "),a=LIPI.replace_all(a,"&amp;",""),a=LIPI.replace_all(a,"<br>","\n"),a=LIPI.replace_all(a,"<br/>","\n"),t=a=LIPI.replace_all(a,"<br />","\n")}let r=!1,n=!1;for(let s=0;s<t.length;s++){let c=t[s];if("<"==c&&l)r=!0,this.dev_text.push(c),this.clear_all_val(!0);else if(r)">"==c&&(r=!1),this.dev_text.push(c);else if("#"!=c||"^"!=t[s+1]||0!=a||n)if(n){if("^"==c&&"#"==t[s+1]){n=!1,s++;continue}this.dev_text.push(c)}else this.dev_text=this.dev_text.join(""),this.dev_text=this.dev_text.split(""),"て"!=c?""==this.next_chars&&c in this.akSharANi?(this.varna[2]="",this.vitaraNa(c,a,h,e,i)):""==this.next_chars&&LIPI.is_upper(c)&&LIPI.to_lower(c)in this.akSharANi?(this.varna[2]="",this.vitaraNa(LIPI.to_lower(c),a,h,e,i)):""!=this.next_chars?LIPI.includes(this.next_chars,c)?(this.d&&(this.halant_add_status=!0,this.d=!1),this.varna[2]=this.varna[1],c=this.varna[0]+c,this.vitaraNa(c,a,h,e,i)):";"==c||"q"==c?(this.clear_all_val(!0),1==a?this.back_space++:0==a&&"Romanized"==i&&this.dev_text.push(";")):c in this.akSharANi?(this.clear_all_val(),this.varna[2]="",""!=this.store_last_of_3&&0!=this.pUrva_lekhit[4][1]&&"Tamil-Extended"==i&&"#"==c&&this.clear_all_val(!0),this.vitaraNa(c,a,h,e,i)):LIPI.is_upper(c)&&LIPI.to_lower(c)in this.akSharANi?(this.clear_all_val(),this.vitaraNa(LIPI.to_lower(c),a,h,e,i)):(this.dev_text.push(c),this.clear_all_val(!0)):(this.dev_text.push(c),this.clear_all_val(!0)):(c=t[++s],this.dev_text.push(c),this.clear_all_val(!0));else n=!0,this.clear_all_val(!0),s++}return this.dev_text=this.dev_text.join(""),0==a?this.dev_text:void 0}vitaraNa(t,a,i,s,e){let l=[!1,["",-1]],h=this.akSharANi[t[0]],r=h[t],n=this.pUrva_lekhit[3][1],c=this.pUrva_lekhit[4][1],o=LIPI.last(r);if(2==this.capital[0]&&1==a&&(t==this.capital[1]?LIPI.time()-this.capital[4]<=4?(t=LIPI.to_upper(t),r=(h=this.akSharANi[t])[t],c=this.capital[3],o=LIPI.last(r),this.back_space+=2*this.capital[5],0==o&&LIPI.includes([1,3],this.pUrva_lekhit[2][1])&&(l=[!0,this.pUrva_lekhit[2]]),LIPI.includes(["Brahmi","Modi","Sharada","Siddham","Granth"],e)&&(this.back_space++,1==c&&this.back_space++,1==this.sa_lang&&(this.back_space-=2,1!=c&&this.back_space++)),this.capital[6]&&(this.back_space--,1==this.sa_lang&&(1==this.capital[3]&&this.back_space--,1==this.capital[2]&&(this.back_space+=2)),1!=this.capital[3]&&1==this.capital[2]&&this.back_space--),0==this.sa_lang&&1==this.capital[2]&&(this.back_space++,1!=this.capital[3]||this.capital[6]||this.back_space++),1==i&&3==this.capital[3]&&this.back_space--,this.capital=[3,"",-1,-1,0,0,!1]):this.capital=[2,t,o,this.pUrva_lekhit[3][1],this.second_cap_time,this.capital[5],!1]:this.capital=[0,"",-1,-1,0,0,!1]),this.mAtrA_sthiti&&LIPI.includes([1,2],o))return this.clear_all_val(!0),void this.vitaraNa(LIPI.last(t),a,i,s,e);if(this.varna[0]=t,this.varna[1]=r[0],1!=c&&3!=c||(1!=o||LIPI.includes(this.next_chars,LIPI.last(t))||0!=i?0==o&&(this.mAtrA_sthiti=!0):(this.halant_add_status=!0,3==c&&(this.back_space++,this.varna[1]=this.store_last_of_3+this.varna[1]))),1==this.capital[0]&&1==a&&(t==this.capital[1]?(this.capital[0]=2,this.second_cap_time=LIPI.time()):LIPI.last(t)==this.capital[1]&&this.akSharANi[LIPI.to_upper(this.capital[1])][LIPI.to_upper(this.capital[1])][0]!=this.varna[1]?(this.capital[6]=!0,this.capital[0]=2,this.capital[2]=o,this.capital[5]=this.varna[1].length,this.second_cap_time=LIPI.time()):this.capital=[0,"",-1,-1,0,0]),"LR"!=t&&"r3"!=t||0!=o||(1!=n?this.mAtrA_sthiti=!1:0==i&&this.back_space++,LIPI.includes(["Modi","Sharada"],e)&&this.back_space++),this.mAtrA_sthiti&&(this.varna[1]=r[1],1==c&&1==i&&(this.back_space+=this.halant.length),3==c?(this.back_space++,1==i&&this.back_space++,this.varna[1]+=this.store_last_of_3,this.last_of_3_status_for_mAtrA=!0):0==c&&this.last_of_3_status_for_mAtrA&&(this.varna[1]+=this.store_last_of_3,this.last_of_3_status_for_mAtrA=!0)),"Tamil-Extended"==e&&"M"==t&&((3==n||0==n&&3==this.pUrva_lekhit[2][1])&&0==c||3==this.capital[0]&&(3==this.pUrva_lekhit[1][1]||0==this.pUrva_lekhit[1][1]&&3==this.pUrva_lekhit[0][1])&&0==this.pUrva_lekhit[2][1])&&(this.varna[1]+=this.store_last_of_3,this.back_space++),"Tamil-Extended"==e&&LIPI.includes(["#an","#s"],t)&&("#an"==t&&(3==this.pUrva_lekhit[1][1]||0==this.pUrva_lekhit[1][1]&&3==this.pUrva_lekhit[0][1])&&0==this.pUrva_lekhit[2][1]?(this.varna[1]+=this.store_last_of_3,this.back_space++):"#s"!=t||3!=this.pUrva_lekhit[2][1]&&0!=this.pUrva_lekhit[2][1]&&3!=this.pUrva_lekhit[1][1]||0!=this.pUrva_lekhit[3][1]||(this.varna[1]+=this.store_last_of_3,this.back_space++,this.special_ved_s=!0)),"Tamil"==e&&"R"==t&&1==c&&2==o&&this.back_space++,"Tamil-Extended"==e&&LIPI.includes(["#ss","#sss"],t)&&this.special_ved_s&&(this.varna[1]+=this.store_last_of_3),1==c&&2==o&&1==t.length&&Object.keys(h).length>1&&0==i)for(let a of LIPI.last(r,-2))if(t+a in h){1==LIPI.last(h[t+a])&&(this.d=!0);break}(LIPI.includes(e,"Tamil")||"Punjabi"==e)&&LIPI.includes(["R","LR","LRR","RR"],t)&&1==o&&(o=2),1==i&&(1==o?this.varna[1]+=this.halant:3==o&&(this.varna[1]=LIPI.substring(this.varna[1],0,-1)+this.halant+LIPI.last(this.varna[1])));let p=this.likha(this.varna[1],this.varna[2],this.back_space,this.halant_add_status);if(0==a){for(let t=0;t<p[1];t++)this.dev_text.pop();this.dev_text.push(p[0])}else if(1==a){let t=!1;if(LIPI.includes(["input","textarea"],s[0].tagName.toLowerCase())&&(t=!0),t){let t=s.val(),a=s[0].selectionStart+1,i=0;this.from_click&&(this.from_click=!1,a++,i=1);let e=0;this.madhye&&(this.madhye=!1,e=1);let l=t.substring(0,a-p[1]-2-e),h=p[0],r="";t.length+1==a?r=t.substring(a+1):t.length+1!=a&&(r=t.substring(a-1-i),1==o&&1==this.sa_lang&&(this.madhye=!0,h+=this.zero_joiner));let n=l.length+h.length;s.val(l+h+r),s.focus(),s[0].selectionStart=n,s[0].selectionEnd=n}else{let t=s.html(),a=new VanillaCaret(s[0]),i=a.getPos()+1;this.from_click&&(i=this.sahayika.abhisthAnam);let e=!1,l=[],h=0;t=LIPI.replace_all(t,"&nbsp;","<费费费费>"),t=LIPI.replace_all(t,"&amp;","<费费费>");let r=!0,n=0,c=0,_="";for(let a=0;a<t.length;a++){let s=t[a];if("<"==s)e=!0;else if(e&&">"==s){"费"==_&&(h++,r&&n++,c++),e=!1,l.push(s);continue}h>=i-2-p[1]&&h<i-2&&!e?(h++,r&&n++,c++):(h!=i-2||e?l.push(s):(l.push("梵"),this.from_click&&l.push(s),r=!1),e||(h++,r&&n++,c++),_=s)}l=l.join(""),l=LIPI.replace_all(l,"<费费费费>","&nbsp;");let d=(l=(l=LIPI.replace_all(l,"<费费费>","&amp;")).split("梵"))[0],I=0;this.madhye&&(this.madhye=!1,d=LIPI.substring(d,0,-1),I=1);let u=p[0],k="";null!=l[1]&&null!=l[1]||(l[1]=""),k=l[1],1==o&&1==this.sa_lang&&c+1!=i&&(this.madhye=!0,u+=this.zero_joiner);let m=d+u+k;s.html(m),this.from_click&&(this.from_click=!1),a.setPos(n+u.length-p[1]-I)}}if(3==this.capital[0]&&(this.capital=[0,"",-1,-1,0,0,!1]),1==t.length&&LIPI.is_lower(t)&&LIPI.to_upper(t)in this.akSharANi&&0==this.capital[0]&&1==a){let a=[0,"",-1,-1,0,0,!1],i=[1,t,o,c,LIPI.time(),this.varna[1].length,!1];t+t in h?this.akSharANi[LIPI.to_upper(t)][LIPI.to_upper(t)][0]!=h[t+t][0]?this.capital=i:this.capital=a:this.capital=i}if(this.next_chars=r[r.length-2],this.sahayika_usage&&1==a){let a={key:[t,this.next_chars],status:[c,o],elm:s,mAtrA:this.mAtrA_sthiti,special_cap:l,lang:e,sa:i};1==this.capital[0]&&(a.cap=!0),this.sahayika.show(a)}3==o&&(this.store_last_of_3=LIPI.last(this.varna[1])),""==this.next_chars&&this.clear_all_val(),this.pUrva_lekhit[0]=this.pUrva_lekhit[1],this.pUrva_lekhit[1]=this.pUrva_lekhit[2],this.pUrva_lekhit[2]=this.pUrva_lekhit[3],this.pUrva_lekhit[3]=this.pUrva_lekhit[4],this.pUrva_lekhit[4]=[t,o]}likha(t,a,i,s){let e=0,l="";if(""==a||""==t)l=t,e=a.length;else if(t[0]!=a[0])l=t,e=a.length;else{let i=0;for(let s in a){a[s];if(t.length==i)break;if(t[i]!=a[i])break;i++}l=t.substring(i),e=a.length-i}return e+=i,s&&(l=this.halant+l),this.back_space=0,this.halant_add_status=!1,[l,e]}clear_all_val(t){this.next_chars="",this.varna=["","",""],this.mAtrA_sthiti=!1,this.last_of_3_status_for_mAtrA=!1,this.special_ved_s=!1,this.back_space=0,t&&(this.pUrva_lekhit=[["",-1],["",-1],["",-1],["",-1],["",-1]],this.store_last_of_3="",this.capital=[0,"",-1,-1,0,0,!1],this.madhye=!1,this.sahayika.pUrvavarNa=[-1,""],this.hide())}antarparivartan(t,a,i,s=!1){"Devanagari"==a&&(a="Sanskrit"),"Devanagari"==i&&(i="Sanskrit"),"Kashmiri"==a&&(a="Urdu"),"Kashmiri"==i&&(i="Urdu"),t=this.anulekhana(t,a,s);let e=t=>LIPI.includes(["Romanized","Normal","Tamil","Telugu","Malayalam","Kannada"],t);return e(i)&&!e(a)&&"Tamil-Extended"!=a&&(t=LIPI.replace_all(t,"o","O"),t=LIPI.replace_all(t,"e","E")),t=this.prakriyA(t,0,i,0,null,s)}anulekhana(t,a,i){let s=[],e=LIPI.pratyakSharAH[a];t=t.split("");let l=["","",""],h=LIPI.akSharAH[a],r=["","",""],n=!1,c=!1,o=0;for(let p=0;p<t.length;p++){let _=t[p];if("<"==_&&i)n=!0,s.push(_);else if(n)">"==_&&(n=!1),s.push(_);else if("#"!=_||"^"!=t[p+1]||c)if(c){if("^"==_&&"#"==t[p+1]){c=!1,p++,s.push("^#");continue}s.push(_)}else{if(LIPI.includes(["\ud805","\ud804"],_)&&LIPI.includes(["Modi","Sharada","Brahmi","Siddham","Granth"],a)&&(_+=t[++p]),l[1]+_ in e&&"百"==LIPI.last(e[l[1]+_])&&""!=l[1]?s[s.length-2]=e[l[1]+_]:l[0]+_ in e&&"百"==LIPI.last(e[l[0]+_])&&""!=l[0]?s[s.length-3]=e[l[0]+_]:l[1]+l[2]+_ in e&&""!=l[2]&&""!=l[1]?(s[s.length-1]=e[l[1]+l[2]+_],2!=o&&(s[s.length-2]="")):l[2]+_ in e&&""!=l[2]?(s[s.length-1]=e[l[2]+_],o++):_ in e&&" "!=_?s.push(e[_]):LIPI.includes(["Romanized","Normal"],a)&&LIPI.includes(LIPI.pUrNasarve.split(""),_)||LIPI.includes("\n; .'#$1234567890".split(""),_)?s.push(_):s.push("て"+_),LIPI.is_null(h[r[1].substring(0,1)])||"基"!=r[2]||"百"!=LIPI.last(r[1])&&"此"!=LIPI.last(r[1])){if(!LIPI.is_null(h[r[2].substring(0,1)])){let t=h[r[2].substring(0,1)];if(!LIPI.is_null(t[r[2]+LIPI.last(s)])){t[r[2]+LIPI.last(s)][0]!=l[2]+_&&(s[s.length-1]=";"+s[s.length-1])}}}else{let t=h[r[1].substring(0,1)];if(!LIPI.is_null(t[LIPI.substring(r[1],0,-1)+LIPI.substring(LIPI.last(s),0,-1)])){t[LIPI.substring(r[1],0,-1)+LIPI.substring(LIPI.last(s),0,-1)][0]!=l[1]+_&&(s[s.length-1]=";"+s[s.length-1])}}0!=o&&3==++o&&(o=0),l[0]=l[1],l[1]=l[2],l[2]=_,r[0]=r[1],r[1]=r[2],r[2]=LIPI.last(s)}else c=!0,p++,s.push("#^")}if(s=s.join(""),!LIPI.includes(["Normal","Romanized","Urdu","Kashmiri"],a)){for(let t of["A","i","I","u","U","e","E","o","O","ai","au","R","RR","LR","LRR"])s=LIPI.replace_all(s,"此."+t,t),s=LIPI.replace_all(s,"百."+t,t);r=["","","",""];for(let t of["a","i","u"])s=LIPI.replace_all(s,"此"+t,"a;"+t),s=LIPI.replace_all(s,"百"+t,"a;"+t);s=LIPI.replace_all(s,"此基",""),s=LIPI.replace_all(s,"百基",""),s=LIPI.replace_all(s,"此","a"),s=LIPI.replace_all(s,"百","a"),s=LIPI.replace_all(s,"基",".x")}return s}add_font(t,a="https://cdn.jsdelivr.net/gh/nirukta/a@main/src/fonts"){let i=["Sharada","Modi","Brahmi","Siddham","Granth"];if(!LIPI.includes(i,t)||LIPI.includes(this.added_fonts,t))return;let s=`LipiFont${i.indexOf(t)+1}`;new FontFace(s,`url(${a}/${t}.ttf)`).load().then(function(t){document.fonts.add(t)}).catch(function(t){}),this.added_fonts.push(t)}}jQuery.fn.lipi_lekhika_add=((t=!1)=>{t?(this.attr("oninput","LipiLekhikA.mukhya($(this), event);"),this.attr("onkeydown","LIPI.clear(event);")):(this.on("input",()=>{LipiLekhikA.mukhya($(this),event)}),this.on("keydown",()=>{LIPI.clear(event)}))}),jQuery.lipi_lekhika=((t=null)=>{let a=$(".Lipi-LekhikA");for(let t of a)LIPI.includes(["span","div","textarea","input"],t.tagName.toLowerCase())&&(t.oninput=(()=>{LipiLekhikA.mukhya($(t),event)}),t.onkeydown=(()=>{LIPI.clear(event)}));null!=t&&setTimeout(()=>$.lipi_lekhika(t),1e3*t)});class लिपिलेखिकालेखनसहायिका{constructor(){this.c=0,this.d=0,this.idAnIma=0,this.reset_capital_status=!1,this.pUrvavarNa=[["","",-1],""],this.closed=!0,this.elm=jQuery("<span>").appendTo("body"),this.elm.css({position:"absolute","background-color":"white",padding:"2.5px",border:"1px solid black","font-weight":"bold",display:"none","z-index":"1000000",cursor:"default","background-color":"white","min-width":"58px","font-family":'"Calibri","Nirmala UI","LipiFont1","LipiFont2","LipiFont3","LipiFont4","LipiFont5"'});let t="",a="";t+="<td><span></span><span></span></td>",a+='<td><a href="https://www.lipilekhika.com" target="_blank"><span style="left:3.5px;height:20px;width:20px;position:absolute;top:7px;"></span></a></td>',t+="<td></td>",a+="<td></td>";for(let i=0;i<60;i++)t+='<td class="लिপিಜಃ"></td>',a+='<td class="लिপিಜಂ"></td>';let i=`<table><tbody><tr>${a}</tr><tr>${t}</tr></tbody></table><div style="font-size: 10.5px;color: purple;"></div>`;this.elm.html(i),this.bhaNDAra_index=["sahayika","pashchAta","akShara","key1","key2"],this.bhaNDAra={sahayika:this.elm.children()[1],key1:0,key2:0,pashchAta:0,akShara:0,tbody:[0,0]};let s=$(this.elm.children()[0]).children()[0];s=$(s).children(),this.adhar=0,this.bhaNDAra.tbody=[s[0],s[1]];let e=$(s[0]).children(),l=$(s[1]).children();this.bhaNDAra.pashchAta=e,this.bhaNDAra.akShara=l,this.bhaNDAra.key1=e[1],this.bhaNDAra.key2=l[1];let h=$(l[0]).children();$(h[1]).css({cursor:"pointer",display:"none",height:"26px",width:"26px",position:"absolute",top:"29px",left:"1px"}),$(h[0]).css({cursor:"pointer",display:"none",height:"26px",width:"26px",position:"absolute",top:"29px",left:"1px"}),this.ins_button=[$(h[1]),$(h[0]),0,0],this.ins_sthiti=1,this.ins_button[this.ins_sthiti].show(),this.ins_button[0].click(()=>this.change_ins(0)),this.ins_button[1].click(()=>this.change_ins(1)),1==this.ins_sthiti&&(this.bhaNDAra.sahayika.style.display="none"),$(s[1]).css({color:"green","font-size":"18px","text-align":"center",cursor:"grab"}),$(s[0]).css({color:"black","font-size":"18px","text-align":"center",cursor:"grab"}),$(this.bhaNDAra.key1).css({color:"brown","font-size":"19.5px","text-align":"center","padding-left":"21.2px","padding-right":"5.6px",cursor:"default"}),$(this.bhaNDAra.key2).css({color:"red","font-size":"15px","text-align":"center","padding-left":"21.2px","padding-right":"5.6px","margin-bottom":"2.5px",cursor:"default"}),this.display={};for(let t=0;t<60;t++)e[t+2].style.display="none",l[t+2].style.display="none";this.objs={down:$(h[0]),up:$(h[1]),icon:$($(e[0]).children()[0])},$(this.objs.icon.children()[0]).css({"background-image":`url(${LIPI.sanchit}/icon.png)`,"background-size":"20px 20px"});let r=['<svg height="26px" class="निच्चैरुच्चैः" style="enable-background:new 0 0 26 26;" version="1.1" viewBox="0 0 512 512" width="26px" xml:space="preserve"><polygon points="396.6,',"160 416,180.7 256,352 96,180.7 115.3,160 256,310.5","352 416,331.3 256,160 96,331.3 115.3,352 256,201.5",'"/></svg>'];h[1].innerHTML=`${r[0]+r[2]+r[3]}`,h[0].innerHTML=`${r[0]+r[1]+r[3]}`;let n=$(".निच्चैरुच्चैः");this.ins_button[2]=n[0],this.ins_button[3]=n[1],this.lang_loaded=!1,this.load_lang=(t=>{this.lang_loaded?this.set_lang(t):$.ajax({url:`${LIPI.sanchit}/sahayika.json`,success:a=>{this.display=a,this.set_lang(t),this.lang_loaded=!0}})}),this.load_lang("English"),this.abhisthAnam=0,$("body").click(t=>{let a=LipiLekhikA,i=this,s=i.bhaNDAra;if("none"==i.elm[0].style.display)return;t=t.target;let e=$(t).parent()[0],l=!1,h=i.ins_button;if(LIPI.includes([h[0][0],h[2]],e)||LIPI.includes([h[1][0],h[3]],e))l=!0;else if(LIPI.includes(s.tbody,e)&&!LIPI.includes([s.key1,s.key2],t)){l=!0;let s=i.adhar,h=e.style.cursor,r=t=>e.style.cursor=t;r("grabbing"),setTimeout(()=>r(h),150);for(let i of t.value)a.from_click=!0,a.prakriyA(i,1,a.script,a.sa_lang,s)}l||a.clear_all_val(!0)}),$("body").dblclick(()=>{let t=LipiLekhikA;"none"!=this.elm[0].style.display&&t.clear_all_val(!0)});let c=":hover{color:blue;}",o=".लिপি",p="{padding:0.5px;}";this.elm.append(`<style>${o}ಜಃ${c}${o}ಜಂ${c}${o}ಜಃ${p}${o}ಜಂ${p}</style>`)}hide_other(t=!1){let a=LipiLekhikA.sahayika;t?a.closed&&(a.sahayika.reset(),a.closed=!0):(1!=a.c||a.closed||(a.reset(),a.closed=!0),a.c--)}change_ins(t){let a=LipiLekhikA.sahayika;a.ins_button[t].hide();let i=Math.abs(t-1);a.ins_sthiti=i,a.ins_button[Math.abs(t-1)].show(),(a=a.bhaNDAra.sahayika).style.display=1==i?"none":"block"}reset(){let t=LipiLekhikA.sahayika;t.elm.hide();for(let a=0;a<t.idAnIma;a++)t.set_labels(2,"",a),t.set_labels(3,"",a),t.hide_elm(1,a),t.hide_elm(2,a),t.idAnIma--}show(t){if(LIPI.includes(t.elm.attr("class"),"Lekhan-SahAyikA-Off"))return;this.reset_capital_status=!1;let a=t.key[1],i=t.key[0],s=t.mAtrA,e=t.special_cap,l=t.lang,h=t.sa;e[0]&&(this.pUrvavarNa=[[LIPI.akSharAH[l][e[1][0]][e[1][0]][0],"",e[1][1]],e[1][0]]),this.adhar=t.elm;let r=t.elm.caret("offset"),n=r.top,c=r.height,o=r.left;if(LIPI.includes(["input","textarea"],t.elm[0].tagName.toLowerCase()))this.abhisthAnam=t.elm.selectionStart+1;else{let a=new VanillaCaret(t.elm[0]);this.abhisthAnam=a.getPos()+2}this.elm[0].style.top=`${n+c}px`,this.elm[0].style.left=`${o+8}px`;let p=["",!1];LIPI.includes(["Urdu","Romanized","Normal","Kashmiri"],LipiLekhikA.script)||(p=[LIPI.akSharAH[l]["."][".x"][0],1==h]);let _=new Map,d=LIPI.akSharAH[l][i[0]],I=0;for(let t of a)if(i+t in d){_.set(t,d[i+t]);for(let a of LIPI.last(d[i+t],-2))i+t+a in d&&(_.set(t+a,d[i+t+a]),I++);I++}let u=0,k=[0,0];if("cap"in t){k[0]=I;let t=LIPI.to_upper(i),a=LIPI.akSharAH[l][t];_.set(i+i,a[t]);let s=LIPI.last(_.get(i+i),-2);for(let e of s)if(t+e in a){_.set(i+i+e,a[t+e]);for(let s of LIPI.last(a[t+e],-2))t+e+s in a&&(_.set(i+i+e+s,a[t+e+s]),I++);I++}k[1]=I+1}if((LIPI.includes([1,3],LIPI.last(this.pUrvavarNa[0]))||s)&&0==LIPI.last(d[i])){let t=this.pUrvavarNa[0][0]+d[i][1];3==LIPI.last(this.pUrvavarNa[0])&&"a"!=i?t=LIPI.substring(t,0,-2)+LIPI.last(t)+LIPI.last(t,-2):3==LIPI.last(this.pUrvavarNa[0])&&"a"==i&&(t=LIPI.last(t,0,-1)+LIPI.last(t)),this.set_labels(4,this.pUrvavarNa[1]+i),this.set_labels(5,t)}else{this.set_labels(4,i);let t=d[i][0]+(LIPI.includes([1,3],LIPI.last(d[i]))?p[0]:"");3==LIPI.last(d[i])&&(t=LIPI.substring(t,0,-2)+LIPI.last(t)+LIPI.last(t,-2)),this.set_labels(5,t)}let m=0;for(let t of _.keys()){if(s&&LIPI.includes([1,2],LIPI.last(_.get(t)))){m++;continue}this.set_labels(2,t,u);let a=_.get(t)[0];0==LIPI.last(_.get(t))&&LIPI.includes([1,3],LIPI.last(this.pUrvavarNa[0]))&&(a=_.get(t)[1]),LIPI.includes([1,3],LIPI.last(_.get(t)))&&p[1]&&(a+=p[0],3==LIPI.last(_.get(t))&&(a=LIPI.substring(a,0,-2)+LIPI.last(a)+LIPI.last(a,-2))),(LIPI.includes([1,3],LIPI.last(this.pUrvavarNa[0]))||s)&&0==LIPI.last(_.get(t))&&(a=this.pUrvavarNa[0][0]+a,3==LIPI.last(this.pUrvavarNa[0])&&(a=LIPI.substring(a,0,-2)+LIPI.last(a)+LIPI.last(a,-2))),this.set_labels(3,a,u),u++}let L=0;for(let t of _.keys())L++;if((L-=m)>=this.idAnIma)for(let t=this.idAnIma;t<L;t++)this.show_elm(1,t),this.show_elm(2,t);else for(let t=L;t<this.idAnIma;t++)this.hide_elm(1,t),this.hide_elm(2,t);this.idAnIma=L,this.c++,s||(this.pUrvavarNa=[d[i],i]),this.closed&&(this.closed=!1),this.elm.show(),"cap"in t&&(this.d++,this.reset_capital_status=!0,setTimeout(function(){!function(t){let a=LipiLekhikA.sahayika;if(a.d--,a.reset_capital_status){if(0==a.d)for(let i=t[0];i<t[1];i++)a.set_labels(2,"",i),a.set_labels(3,"",i),a.hide_elm(1,i),a.hide_elm(2,i),a.idAnIma--;LipiLekhikA.capital=[0,"",-1,-1,0,0,!1]}}(k)},4e3));let v=this.hide_other;setTimeout(function(){v()},15e3)}hide_elm(t,a){this.bhaNDAra[["pashchAta","akShara"][t-1]][a+2].style.display="none"}show_elm(t,a){this.bhaNDAra[["pashchAta","akShara"][t-1]][a+2].style.removeProperty("display")}set_labels(t,a,i=-1){-1==i||3!=t&&2!=t?this.bhaNDAra[this.bhaNDAra_index[t-1]].innerHTML=a:(i+=2,t--,this.bhaNDAra[this.bhaNDAra_index[t]][i].innerHTML=a,2==t?(this.bhaNDAra.akShara[i].title=a,this.bhaNDAra.pashchAta[i].title=a):1==t&&(this.bhaNDAra.akShara[i].value=a,this.bhaNDAra.pashchAta[i].value=a))}set_lang(t){let a=this.display[t];this.set_labels(1,LIPI.text_to_html(a.ins)),this.elm.attr("title",a.title);for(let t in this.objs)this.objs[t].attr("title",a[t])}}let LipiLekhikA=new लिपिलेखिकापरिवर्तक;